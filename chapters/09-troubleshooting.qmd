# Troubleshooting

## Common Errors

### "Agent 'name' not found"

Agent referenced but not defined:

```lua
-- Wrong
Agent("researcher").turn()

-- Right: Define agent first
Agent "researcher" { ... }
Agent("researcher").turn()
```

### "Provider not specified"

Agent missing provider:

```lua
-- Wrong
Agent "worker" {
    system_prompt = "..."
}

-- Right
Agent "worker" {
    provider = "openai",
    system_prompt = "..."
}
```

### "Required output field missing"

Procedure didn't return required field:

```lua
Procedure "main" {
    output = {
        result = field.string{required = true}
    },
    function()
        -- Wrong: no return
        Log.info("Done")

        -- Right: return all required fields
        return {result = "completed"}
    end
}
```

### "Tool 'name' not available"

Tool not in agent's toolsets:

```lua
-- Wrong
Agent "worker" {
    toolsets = {"done"}
}
-- search tool called but not available

-- Right
Agent "worker" {
    toolsets = {"search", "done"}
}
```

## Debugging Checkpoints

View execution trace:

```bash
tactus trace-list
tactus trace-show <trace-id>
```

## API Issues

### Rate limits

Add delays or reduce parallelism.

### Timeouts

Check network connectivity. Consider retry logic.

### Invalid API key

Verify key in config or environment:

```bash
echo $OPENAI_API_KEY
cat .tactus/config.yml
```

## Performance Issues

### Slow execution

- Check model selection (gpt-4o-mini faster than gpt-4o)
- Review token usage
- Consider caching

### High costs

- Use smaller models for simple tasks
- Reduce max_tokens
- Review tool call frequency

## Test Failures

### "Step not found"

Custom step not defined or typo in step text.

### "Specification failed"

Check that agent behavior matches spec. Run with verbose output:

```bash
tactus test procedure.tac --verbose
```
